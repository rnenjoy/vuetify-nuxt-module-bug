import { getClient } from '@sentry/core';
import { browserTracingIntegration, vueIntegration } from '@sentry/vue';
import { defineNuxtPlugin } from 'nuxt/app';

// --- Types are copied from @sentry/vue (so it does not need to be exported) ---
// The following type is an intersection of the Route type from VueRouter v2, v3, and v4.
// This is not great, but kinda necessary to make it work with all versions at the same time.

const sentry_client = defineNuxtPlugin(nuxtApp => {
  // This evaluates to true unless __SENTRY_TRACING__ is text-replaced with "false", in which case everything inside
  // will get tree-shaken away
  if (typeof __SENTRY_TRACING__ === 'undefined' || __SENTRY_TRACING__) {
    const sentryClient = getClient();

    if (sentryClient && '$router' in nuxtApp) {
      sentryClient.addIntegration(
        browserTracingIntegration({ router: nuxtApp.$router , routeLabel: 'path' }),
      );
    }
  }

  nuxtApp.hook('app:created', vueApp => {
    const sentryClient = getClient();

    if (sentryClient) {
      sentryClient.addIntegration(vueIntegration({ app: vueApp }));
    }
  });
});

export { sentry_client as default };
//# sourceMappingURL=sentry.client.js.map
