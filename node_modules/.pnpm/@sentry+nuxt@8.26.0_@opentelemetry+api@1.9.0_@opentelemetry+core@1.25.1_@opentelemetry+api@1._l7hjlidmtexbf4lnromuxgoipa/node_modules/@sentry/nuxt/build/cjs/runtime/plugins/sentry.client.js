const core = require('@sentry/core');
const vue = require('@sentry/vue');
const app = require('nuxt/app');

// --- Types are copied from @sentry/vue (so it does not need to be exported) ---
// The following type is an intersection of the Route type from VueRouter v2, v3, and v4.
// This is not great, but kinda necessary to make it work with all versions at the same time.

const sentry_client = app.defineNuxtPlugin(nuxtApp => {
  // This evaluates to true unless __SENTRY_TRACING__ is text-replaced with "false", in which case everything inside
  // will get tree-shaken away
  if (typeof __SENTRY_TRACING__ === 'undefined' || __SENTRY_TRACING__) {
    const sentryClient = core.getClient();

    if (sentryClient && '$router' in nuxtApp) {
      sentryClient.addIntegration(
        vue.browserTracingIntegration({ router: nuxtApp.$router , routeLabel: 'path' }),
      );
    }
  }

  nuxtApp.hook('app:created', vueApp => {
    const sentryClient = core.getClient();

    if (sentryClient) {
      sentryClient.addIntegration(vue.vueIntegration({ app: vueApp }));
    }
  });
});

module.exports = sentry_client;
//# sourceMappingURL=sentry.client.js.map
